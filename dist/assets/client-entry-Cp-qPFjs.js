const f="growi-plugin-default-user-search",h={name:f};function m(){const e=location.pathname;return e.includes("/_search")||e.includes("/search")}function d(e){var t,c;const n=Array.from(e.querySelectorAll("label, span, div, button"));for(const s of n){if(!(s.textContent||"").trim().includes("/user"))continue;const u=s.querySelector('input[type="checkbox"]');if(u)return u.checked||u.click(),!0;const r=s.previousElementSibling;if((t=r==null?void 0:r.matches)!=null&&t.call(r,'input[type="checkbox"]'))return r.checked||r.click(),!0;const o=s.nextElementSibling;if((c=o==null?void 0:o.matches)!=null&&c.call(o,'input[type="checkbox"]'))return o.checked||o.click(),!0;const l=s.htmlFor;if(l){const i=e.querySelector(`#${CSS.escape(l)}`);if((i==null?void 0:i.type)==="checkbox")return i.checked||i.click(),!0}}return!1}function w(){const e=new URL(location.href),n=e.searchParams.has("q")?"q":e.searchParams.has("query")?"query":null;if(!n)return!1;const t=e.searchParams.get(n)||"";if(!t)return!1;const c=t.replace(/\s*-prefix:\/user\/?/g," ").replace(/\s{2,}/g," ").trim();return c!==t?(e.searchParams.set(n,c),history.replaceState({},"",e.toString()),window.dispatchEvent(new Event("popstate")),!0):!1}const a="gp_incuser__applied";function p(){if(!m()||document.body[a]||(document.body[a]=!0,d(document)))return;new MutationObserver((n,t)=>{d(document)&&t.disconnect()}).observe(document.body,{childList:!0,subtree:!0}),w()}function y(){const e=window.history;if(e.__gp_patched)return;const n=e.pushState;e.pushState=function(...t){const c=n.apply(this,t);return window.dispatchEvent(new Event("pushstate")),c},e.__gp_patched=!0}function g(){y();const e=()=>{document.body[a]=!1,p()};p(),window.addEventListener("popstate",e),window.addEventListener("pushstate",e)}const b=()=>{g()},k=()=>{};window.pluginActivators=window.pluginActivators??{};window.pluginActivators[h.name]={activate:b,deactivate:k};
